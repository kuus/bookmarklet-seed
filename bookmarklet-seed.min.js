!function(e,t){function i(i,n){if("undefined"==typeof e.jQuery){var o=function(){e.jQuery?(r=e.jQuery,n()):e.setTimeout(function(){o()},100)},a=t.createElement("script");a.type="text/javascript",a.readyState?a.onreadystatechange=function(){("loaded"==a.readyState||"complete"==a.readyState)&&(a.onreadystatechange=null,o())}:a.onload=function(){o()},a.src=i,t.getElementsByTagName("head")[0].appendChild(a)}else r=e.jQuery,n()}function n(e,t){for(var i=0,n=e.length,o=function(){i++,i===n&&t()},a=0;n>a;a++)r.getScript(e[a],o)}function o(e){for(var i=t.getElementsByTagName("head")[0],n=0,o=e.length;o>n;n++){var a=t.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=e[n],i.appendChild(a)}}function a(e){var i=t.head||t.getElementsByTagName("head")[0],n=t.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(t.createTextNode(e)),i.appendChild(n)}function s(e){var t=this.scrollTop,i=this.scrollHeight,n=this.offsetHeight,o=e.originalEvent.wheelDelta,a=o>0,s=function(){return e.stopPropagation(),e.preventDefault(),e.returnValue=!1,!1};return!a&&-o>i-n-t?(this.scrollTop=i,s()):a&&o>t?(this.scrollTop=0,s()):void 0}var r,d,l,c,u,p,f,h,m,g="kuus",y=350,v={jquery:{min:">1.8",desired:"//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"},js:["//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js","//rawgit.com/polomoshnov/jQuery-UI-Resizable-Snap-extension/master/jquery.ui.resizable.snap.ext.v1.9.min.js"],css:["//code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css"]},b=g,x=g+"-cage",k=g+"-wrapper",w=g+"-iframe-app",j=g+"-iframe-overlay",z=g+"-header",S=g+"-title",T=g+"-control-close",E=g+"-control-toggle",I='<div id="kuus-cage"></div><div id="kuus-wrapper"><div id="kuus-wrap" class="kuus-cover"><div id="kuus-header"><div id="kuus-controls"><span id="kuus-control-close" class="kuus-control">x</span> <span id="kuus-control-toggle" class="kuus-control">-</span></div><h1 id="kuus-title">Bookmarklet</h1></div><div id="kuus-container"><div id="kuus-iframe-wrap" class="kuus-cover"><iframe id="kuus-iframe-app" name="kuus-iframe-app" src="javascript:false;" scrolling="0" frameborder="0" sandbox="allow-scripts allow-same-origin" seamless=""></iframe><div id="kuus-iframe-overlay" class="kuus-cover"></div></div></div></div></div>',B='#kuus-cage{z-index:-1;position:fixed;top:0;left:0;bottom:0;right:0;pointer-events:none}#kuus-wrapper{z-index:9999999999;position:fixed!important;top:0;left:0;width:350px;height:100%}#kuus-wrap{position:absolute;border:1px solid #f7f7f7;background:#fff;-webkit-box-shadow:0 16px 28px 0 rgba(0,0,0,.22),0 25px 55px 0 rgba(0,0,0,.21);box-shadow:0 16px 28px 0 rgba(0,0,0,.22),0 25px 55px 0 rgba(0,0,0,.21)}#kuus-header{z-index:1;position:relative;height:30px;border-bottom:1px solid #f7f7f7;background:#ededed;cursor:move;cursor:drag;cursor:grabbing;cursor:-webkit-grabbing;cursor:-moz-grabbing}#kuus-title{float:none;margin:0;padding:5px;line-height:20px;border:0;white-space:nowrap;overflow:hidden;color:#666;text-overflow:ellipsis;text-align:left;text-transform:uppercase;font-family:"Lucida Grande","Lucida Sans Unicode","Lucida Sans",Garuda,Verdana,Tahoma,sans-serif;font-size:13px;font-weight:100;letter-spacing:0}#kuus-controls{float:right}#kuus-container{position:absolute;top:30px;bottom:0;left:0;right:0;width:100%}#kuus-iframe-wrap{position:relative}#kuus-iframe-app{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%}#kuus-iframe-overlay{display:none;position:absolute;opacity:0}.kuus-cover{top:0;left:0;width:100%;height:100%}.kuus-control{display:block;float:right;width:30px;height:29px;line-height:30px;background:#ededed;color:#666;text-align:center;font-size:16px;font-family:"Lucida Grande","Lucida Sans Unicode","Lucida Sans",Garuda,Verdana,Tahoma,sans-serif;font-weight:100;cursor:pointer}.kuus-control:hover{background:#fcfcfc;color:#444}',D='<!doctype html><html><head><style>body{margin:0;padding:0;font:13px/1.3 "Lucida Grande","Lucida Sans Unicode","Lucida Sans",Garuda,Verdana,Tahoma,sans-serif}.cover,#iframe-wrapper{top:0;left:0;width:100%;height:100%}#iframe-wrapper{position:absolute;padding:5px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}#iframe-wrap{position:relative}#iframe-overlay-trap{display:none;position:absolute;opacity:0}#iframe{visibility:visible;position:absolute;padding:0;margin:0}</style><title>Word reference</title></head><body><div id="iframe-wrapper"><div id="iframe-wrap" class="cover"><iframe id="iframe" class="cover" frameborder="0" src="http://wordreference.com/" seamless="" sandbox="allow-forms"></iframe></div></div><script>!function(e,n){function t(){if(f.getSelection){var e=f.getSelection();return e.toString()}if(s.selection.createRange){var e=s.selection.createRange();return e.text}}function r(){l(s).on("mouseup",function(){var e=o(t());e&&e!==d&&c(e)<=2&&(i(e),d=e)})}function o(e){return e.replace(/^\\s\\s*/,"").replace(/\\s\\s*$/,"")}function c(e){return e.match(/\\S+/g).length}function i(e){var n=a.src,t=n.substr(n.lastIndexOf("/")+1),r=t?n.substring(n.lastIndexOf(g)+1,n.lastIndexOf(t)-t.length):"enit";console.log("http://wordreference.com/"+r+"/"+encodeURIComponent(e))}function u(){a=n.getElementById("iframe"),r()}var a,f=e.parent,s=e.parent.document,l=f.jQuery,g="http://wordreference.com/",d="";u()}(window,document);</script></body></html>',L=function(){this.initialize.apply(this,arguments)};L.prototype={initialize:function(){var t=this;this.active=!0,this.position={top:0,left:0},this.size={width:y,height:e.innerHeight},this.active=!1,this.createDom(),i(v.jquery.desired,function(){a(B),o(v.css),t.bindControls(),t.initInnerApp(),n(v.js,function(){t.initDrag()})})},createDom:function(){var e=t.createDocumentFragment();d=t.createElement("div"),d.id=b,d.innerHTML=I,e.appendChild(d),t.body.appendChild(e),this.assignDom()},assignDom:function(){l=t.getElementById(k),u=t.getElementById(j),p=t.getElementById(z),f=t.getElementById(S),h=t.getElementById(T),m=t.getElementById(E),c=t.getElementById(w)},initInnerApp:function(){var e=this;c.contentWindow.document.open(),c.contentWindow.document.write(D),c.contentWindow.document.close(),c.onload=function(){e.setTitle(c.contentDocument.title)}},setTitle:function(e){f.innerHTML=e},initDrag:function(){var e=this,t=this.size.width,i=function(){u.style.display="block"},n=function(t,i){e.position=i.position,e.size=i.size?i.size:e.size,u.style.display="none"};r(l).draggable({containment:"#"+x,scroll:!1,snap:"#"+x,snapTolerance:20,snapMode:"inner",opacity:.8,start:i,stop:n}).resizable({containment:"#"+x,maxWidth:768,minWidth:t,handles:"all",snap:"#"+x,snapTolerance:20,snapMode:"inner",start:i,stop:n}).on("DOMMouseScroll mousewheel",s)},bindControls:function(){var e=this;r(h).on("click",e.destroy),r(m).on("click",e.toggle),r(p).on("dblclick",e.toggle)},toggle:function(){this.minimized?(l.style.width=this.size.width+"px",l.style.height=this.size.height+"px",this.className+=" kuus-control-open",this.minimized=!1):(l.style.height=p.offsetHeight+"px",l.style.width=y+"px",this.className="kuus-control",this.minimized=!0)},destroy:function(){this.active=!1,d.parentNode.removeChild(d),e.kuus={},delete e.kuus}},e.kuus=new L}(window,document);