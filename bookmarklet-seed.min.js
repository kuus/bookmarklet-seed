!function(e,t){function i(i,o){if("undefined"==typeof e.jQuery){var n=function(){e.jQuery?(a=e.jQuery,o()):e.setTimeout(function(){n()},100)},s=t.createElement("script");s.type="text/javascript",s.readyState?s.onreadystatechange=function(){("loaded"==s.readyState||"complete"==s.readyState)&&(s.onreadystatechange=null,n())}:s.onload=function(){n()},s.src=i,t.getElementsByTagName("head")[0].appendChild(s)}else a=e.jQuery,o()}function o(e,t){for(var i=0,o=e.length,n=function(){i++,i===o&&t()},s=0;o>s;s++)a.getScript(e[s],n)}function n(e){for(var i=t.getElementsByTagName("head")[0],o=0,n=e.length;n>o;o++){var s=t.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=e[o],i.appendChild(s)}}function s(e){var i=t.head||t.getElementsByTagName("head")[0],o=t.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(t.createTextNode(e)),i.appendChild(o)}function r(e){var t=this.scrollTop,i=this.scrollHeight,o=this.offsetHeight,n=e.originalEvent.wheelDelta,s=n>0,r=function(){return e.stopPropagation(),e.preventDefault(),e.returnValue=!1,!1};return!s&&-n>i-o-t?(this.scrollTop=i,r()):s&&n>t?(this.scrollTop=0,r()):void 0}var a,l,c,u,d,p,f,h,m,g="kuus",v=350,y={jquery:{min:">1.8",desired:"//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"},js:["//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js","//rawgit.com/polomoshnov/jQuery-UI-Resizable-Snap-extension/master/jquery.ui.resizable.snap.ext.v1.9.min.js"],css:["//code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css"]},b=g,x=g+"-cage",w=g+"-wrapper",k=g+"-iframe-app",z=g+"-iframe-overlay",j=g+"-header",E=g+"-control-close",T=g+"-control-toggle",B='<div id="kuus-cage"></div><div id="kuus-wrapper"><div id="kuus-wrap" class="kuus-cover"><div id="kuus-header"><div id="kuus-controls"><span id="kuus-control-close" class="kuus-control">x</span> <span id="kuus-control-toggle" class="kuus-control">-</span></div><h1 id="kuus-title">Translator</h1></div><div id="kuus-container"><div id="kuus-iframe-wrap" class="kuus-cover"><iframe id="kuus-iframe-app" name="kuus-iframe-app" src="javascript:false;" scrolling="0" frameborder="0" sandbox="allow-scripts allow-same-origin" seamless=""></iframe><div id="kuus-iframe-overlay" class="kuus-cover"></div></div></div></div></div>',C='#kuus-cage{z-index:-1;position:fixed;top:0;left:0;bottom:0;right:0}#kuus-wrapper{z-index:9999999999;position:fixed!important;top:0;left:0;width:350px;height:100%}#kuus-wrap{position:absolute;border:1px solid #f7f7f7;background:#fff;-webkit-box-shadow:0 0 20px 0 rgba(0,0,0,.25);box-shadow:0 0 20px 0 rgba(0,0,0,.25)}#kuus .kuus-cover{top:0;left:0;width:100%;height:100%}#kuus-header{z-index:1;position:relative;height:30px;border-bottom:1px solid #f7f7f7;background:#fff;cursor:move;cursor:drag;cursor:grabbing;cursor:-webkit-grabbing;cursor:-moz-grabbing}#kuus-title{float:none;margin:0;padding:5px;line-height:20px;border:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left;font-family:"Century Gothic","Avenir Next",Futura,"URW Gothic L",sans-serif,"Malgun Gothic";color:#999;text-transform:uppercase;font-size:15px;font-weight:100}#kuus-controls{float:right}#kuus-container{position:absolute;top:30px;bottom:0;left:0;right:0;width:100%}#kuus-iframe-wrap{position:relative}#kuus-iframe-app{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%}#kuus-iframe-overlay{display:none;position:absolute;opacity:0}.kuus-control{height:30px;line-height:30px;text-align:center;width:30px;display:block;float:right;font-size:20px;color:#999;background:#fff;border-left:1px solid #f7f7f7;cursor:pointer}.kuus-control:hover{color:#666;background:#f7f7f7}',S='<!doctype html><html><head><style>.cover{top:0;left:0;width:100%;height:100%}#iframe-wrapper{position:absolute;top:30%;left:0;width:100%;height:70%;padding:5px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}#iframe-wrap{position:relative}#iframe-overlay-trap{display:none;position:absolute;opacity:0}#iframe{visibility:visible;position:absolute;padding:0;margin:0}</style><title>Translator</title></head><body><div class="selected-text"></div><div id="iframe-wrapper"><div id="iframe-wrap" class="cover"><iframe id="iframe" class="cover" name="kuus-iframe" frameborder="0" src="http://wordreference.com/" sandbox="allow-same-origin allow-forms" seamless=""></iframe><div id="iframe-overlay-trap" class="cover"></div></div></div><script>!function(){function e(){if(s.getSelection){var e=s.getSelection();return e.toString()}if(f.selection.createRange){var e=f.selection.createRange();return e.text}}function n(){f.addEventListener("mouseup",function(){var n=t(e());if(n&&n!==u){if(r(n)>2)return;i.innerHTML=n,o(n),u=n}},!1)}function t(e){return e.replace(/^\\s\\s*/,"").replace(/\\s\\s*$/,"")}function r(e){return e.match(/\\S+/g).length}function o(e){a.src="http://wordreference.com/enit/"+encodeURIComponent(e)}function c(){a=document.getElementById("iframe"),i=document.getElementsByClassName("selected-text")[0],n()}console.log("Inside iframe, appjs",window.parent);var i,a,u="",s=window.parent,f=window.parent.document;c()}();</script></body></html>',D=function(){this.initialize.apply(this,arguments)};D.prototype={initialize:function(){var t=this;this.active=!0,this.position={top:0,left:0},this.size={width:v,height:e.innerHeight},this.active=!1,this.createDom(),this.assignDom(),i(y.jquery.desired,function(){s(C),n(y.css),o(y.js,function(){t.initDrag(),t.bindControls()})})},createDom:function(){var e=t.createDocumentFragment();c=t.createElement("div"),c.id=b,c.innerHTML=B,e.appendChild(c),t.body.appendChild(e),d=t.getElementById(k),d.contentWindow.document.open(),d.contentWindow.document.write(S),d.contentWindow.document.close()},assignDom:function(){l=t.getElementsByTagName("html")[0],u=t.getElementById(w),p=t.getElementById(z),f=t.getElementById(j),h=t.getElementById(E),m=t.getElementById(T)},initDrag:function(){var e=this,t=this.size.width,i=function(){p.style.display="block"},o=function(t,i){e.position=i.position,e.size=i.size?i.size:e.size,p.style.display="none"},n=function(e,t){console.log(t)};a(u).draggable({containment:"#"+x,scroll:!1,snap:"#"+x,snapTolerance:20,snapMode:"inner",opacity:.8,start:i,stop:o,drag:n}).resizable({containment:"#"+x,maxWidth:768,minWidth:t,handles:"all",snap:"#"+x,snapTolerance:20,snapMode:"inner",start:i,stop:o,resize:n}).on("DOMMouseScroll mousewheel",r),l.style.position="relative",l.style.marginLeft=t+"px"},bindControls:function(){var e=this;a(h).on("click",function(){e.destroy()}),a(m).on("click",function(){e.toggle()}),a(f).on("dblclick",function(){e.toggle()})},toggle:function(){this.minimized?(u.style.width=this.size.width+"px",u.style.height=this.size.height+"px",this.className+=" kuus-control-open",this.minimized=!1):(u.style.height=f.offsetHeight+"px",u.style.width=v+"px",this.className="kuus-control",this.minimized=!0)},destroy:function(){this.active=!1,c.parentNode.removeChild(c),e.kuus={},delete e.kuus}},e.kuus=new D}(window,document);